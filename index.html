<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="javascript library for playing video on canvas elements">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>canvid.js</title>

    <link rel="stylesheet" type="text/css" href="styles/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="styles/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="styles/prism.css" media="screen">
    <style type="text/css">
    .canvid-buttons button {
        display: none;
    }
    
    .frames-gif {
        width: 500px;
        height: 375px;
    }
    </style>
</head>

<body>
    <section class="page-header">
        <h1 class="project-name">canvid.js</h1>
        <h2 class="project-tagline">tiny library for playing video on canvas elements</h2>
        <a href="https://github.com/gka/canvid" class="btn">View on GitHub</a>
        <a href="https://github.com/gka/canvid/zipball/master" class="btn">Download .zip</a>
        <a href="https://github.com/gka/canvid/tarball/master" class="btn">Download .tar.gz</a>
    </section>
    <section class="main-content">
        <h1>
          <a id="canvidjs" class="anchor" href="#canvidjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>canvid.js
        </h1>
        <p>
            <strong>canvid</strong> is a tiny dependency free library for playback of relatively short videos on canvas elements.</p>
        <ul>
            <li>
                <p><strong>Why not just use HTML5 video?</strong>
                    <br> Because you can't embed and autoplay HTML5 videos on iOS! Yeah, that sucks.</p>
            </li>
            <li>
                <p><strong>Why is this better than using an animated GIF?</strong>
                    <br> Videos look kind of gross when converted to animated GIFs because of the colors sampling. Also the file size of video GIFs can get pretty huge. GIF is just not made for videos. JPG does a much better job of compressing video frames. Also, animated GIFs don't give you any playback controls. You can't pause a GIF or delay it's playback. With canvid you can do that.</p>
            </li>
            <li>
                <p><strong>Why only "relatively short" videos?</strong>
                    <br> As you see further down, the container format for canvid is a big image sprite of all the frames of each clip. Sadly, iOS limits the maximum image size (bigger image get sampled down), so that puts a limit on the maximum frames you can store.</p>
            </li>
            <li>
                <p><strong>Why is there no audio?</strong>
                    <br> canvid doesn't support audio for the same reason animated GIF doesn't support audio either: because that's not what it was built for.</p>
            </li>
        </ul>
        <h2>
  <a id="demo" class="anchor" href="#demo" aria-hidden="true"><span class="octicon octicon-link"></span></a>Demo
</h2>
        <p>We created the sprite for this demo with the tools <a href="#how-to-convert-your-video-to-a-jpg-sprite">descriped below</a>. The <a href="images/canvid-example.jpg">sprite</a> has about <strong>700kb</strong>.</p>
        <div id="canvid-example"></div>
        <div class="canvid-buttons">
            <button class="canvid-ctrl" id="play" data-fps="15">Play (15fps)</button>
            <button class="canvid-ctrl" id="play60" data-fps="60">Play (60fps)</button>
            <button class="canvid-ctrl" id="pause">Pause</button>
            <button class="canvid-ctrl" id="reverse" data-fps="15">Reverse</button>
        </div>
        <h2>
  <a id="gif-comparison"  href="#gif-comparison" class="anchor" href="#demo" aria-hidden="true"><span class="octicon octicon-link"></span></a>GIF Comparison
</h2>
        <p>These are the same frames converted to a GIF. The GIF has about <strong>4.9mb</strong>.</p>
        <img class="frames-gif" src="images/frames.gif" />
        <p>The GIF was created with these commands:</p>
        <pre><code class="language-bash">ffmpeg -i myvideo.mp4 -vf scale=375:-1 -r 5 frames/%04d.png
convert -loop 0 -delay 5 -colors 75 frames/*.png -fuzz "40%" output.gif</code></pre>
        
        <h2>
            <a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation
        </h2>

        <p><strong>npm</strong></p>
        <pre><code class="language-bash">npm install --save canvid</code></pre>
        
        <p><strong>git clone</strong></p>
        <pre><code class="language-bash">git clone git@github.com:gka/canvid.git</code></pre>
        
        <h2>
            <a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage
        </h2>
        <p>You can use canvid.js with AMD, CommonJS and browser globals.</p>

        <pre ><code class="language-javascript">
var canvidControl = canvid({
    selector : '.video',
    videos: {
        clip1: { src: 'clip1.jpg', frames: 38, cols: 6, loops: 1, onEnd: function(){
          console.log('clip1 ended.');
          canvidControl.play('clip2');
        }},
        clip2: { src: 'clip2.jpg', frames: 43, cols: 6, fps: 24 }
    },
    width: 500,
    height: 400,
    loaded: function() {
        canvidControl.play('clip1');
        // reverse playback
        // canvidControl.play('clip1', true);
    }
});</code>
        </pre>



        <h2>
            <a id="options" class="anchor" href="#options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Options
        </h2>

        <ul>
            <li>
                <p><strong>videos</strong> required
                    <br> Video/Sprite objects (videoKey : videoOptions).</p>
                <ul>
                    <li>
                        <p><strong>src</strong> required
                            <br> Path of the sprite image.</p>
                    </li>
                    <li>
                        <p><strong>frames</strong> required
                            <br> Number of frames. </p>
                    </li>
                    <li>
                        <p><strong>cols</strong> required
                            <br> Number of columns. </p>
                    </li>
                    <li>
                        <p><strong>loops</strong> optional
                            <br> Number of loops.</p>
                    </li>
                    <li>
                        <p><strong>fps</strong> optional (default: 15)
                            <br>Frames per second.</p>
                    </li>
                    <li>
                        <p><strong>onEnd</strong> optional 
                            <br>Function that gets called when the clip ended.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p><strong>selector</strong> optional (default: '.canvid-wrapper')
                    <br> The selector of the element where the video gets displayed.</p>
            </li>
            <li>
                <p><strong>width</strong> optional (default: 800)
                    <br> Width of the element where the video gets displayed.</p>
            </li>
            <li>
                <p><strong>height</strong> optional (default: 450)
                    <br> Height of the element where the video gets displayed.</p>
            </li>
            <li>
                <p><strong>loaded</strong> optional
                    <br> Function that gets called when all videos are loaded.</p>
            </li>
            <li>
                <p><strong>srcGif</strong> optional
                    <br> Path of the fallback gif, if canvas is not supported. </p>
            </li>
        </ul>
        <h2>
            <a id="methods" class="anchor" href="#methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Methods
        </h2>
        <p>The canvid function returns an object to control the video:</p>

        
        <pre><code class="language-javascript">var canvidControl = canvid(canvidOptions);</code></pre>
        
        
        <p><strong>play</strong>
        <br>Plays video of the passed videoKey. The parameters isReverse (default: false) and fps (default: 15) are optional.</p>
        
        <pre><code class="language-javascript">canvidControl.play(videoKey [,isReverse, fps]);</code></pre>
        <p><strong>pause</strong>
        <br>Pause current video. </p>
        
        <pre><code class="language-javascript">canvidControl.pause();</code></pre>
        
        <p><strong>resume</strong>
        <br>Resume current video.</p>
        <pre><code class="language-javascript">canvidControl.resume();</code></pre>
        
        <p><strong>destroy</strong>
        <br>Stops video and removes the canvas of the current canvid element from the DOM.</p>
        <pre><code class="language-javascript">canvidControl.destroy();</code></pre>

        <p><strong>isPlaying</strong>
        <br>Returns true or false whether the video is playing or not.</p>
        <pre><code class="language-javascript">canvidControl.isPlaying();</code></pre>

        <p><strong>getCurrentFrame</strong>
        <br>Returns the current frame number.</p>
        <pre><code class="language-javascript">canvidControl.getCurrentFrame();</code></pre>

        <p><strong>setCurrentFrame</strong>
        <br>Sets the current frame number.</p>
        <pre><code class="language-javascript">canvidControl.setCurrentFrame(0);</code></pre>
        

        <h2>
            <a id="how-to-convert-your-video-to-a-jpg-sprite" class="anchor" href="#how-to-convert-your-video-to-a-jpg-sprite" aria-hidden="true">
                <span class="octicon octicon-link"></span></a>How to convert your video to a JPG sprite
            </h2>
        <p>First, convert you video into single frames using <a href="https://www.ffmpeg.org/">ffmpeg</a>:</p>
        
        <pre><code class="language-bash">ffmpeg -i myvideo.mp4 -vf scale=375:-1 -r 5 frames/%04d.png</code></pre>

        <p>Then, use ImageMagicks <a href="http://www.imagemagick.org/script/montage.php">montage</a> to stich all the frames into one big image:</p>
        
        <pre><code class="language-bash">montage -border 0 -geometry 375x -tile 6x -quality 60% frames/*.png myvideo.jpg</code></pre>
        
        <h2><a id="user-content-is-canvid-responsive" class="anchor" href="#is-canvid-responsive" aria-hidden="true"><span class="octicon octicon-link"></span></a>Is canvid responsive?</h2>
        <p>Yes it is, thanks to a nice little trick. Regardless of what  <code>width</code> and <code>height</code> parameters you set in the canvid constructor, you can use <code>style="width:100%"</code> on the canvas element and it will get scaled to the outer container and preserve its original aspect ratio.</p>
        <pre><code class="language-css">.canvid {
  width: 100%;
}</code></pre>
        
        <h2>
            <a id="contributors" class="anchor" href="#contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributors
        </h2>

        <ul>
            <li><a href="http://driven-by-data.net">Gregor Aisch</a></li>
            <li><a href="http://moritzklack.com">Moritz Klack</a></li>
        </ul>

    </section>

    <script src="scripts/prism.js"></script>
    <script src="scripts/canvid.js"></script>
    <script src="scripts/example.js"></script>
</body>

</html>
